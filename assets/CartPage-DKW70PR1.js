import{r as i,K as Y,Q as ke,H as Ce,e as ie,h as ce,w as de,y as z,l as Re,T as Se,o as L,i as J,R as A,k as $e,s as oe,n as ue,$ as me,m as pe,_ as xe,p as Pe,I as Oe,U as Ee,q as _e,t as Me,v as F,P as ae,F as H,x as re,z as De,A as he,B as Ie,j as e,C,D as Ae,u as fe,a as G,E as ge,G as Te,L as K,J as S,M as Fe,N as ne,O as qe,f as Ue,S as Le,V as Ge,W as Ve,X as Qe,Y as He}from"./index-C2ouFS6a.js";function We(s,t){return s!==null&&t!==null&&typeof s=="object"&&typeof t=="object"&&"id"in s&&"id"in t?s.id===t.id:s===t}function Be(s=We){return i.useCallback((t,r)=>{if(typeof s=="string"){let a=s;return(t==null?void 0:t[a])===(r==null?void 0:r[a])}return s(t,r)},[s])}var Ke=(s=>(s[s.RegisterOption=0]="RegisterOption",s[s.UnregisterOption=1]="UnregisterOption",s))(Ke||{});let Ye={0(s,t){let r=[...s.options,{id:t.id,element:t.element,propsRef:t.propsRef}];return{...s,options:Ie(r,a=>a.element.current)}},1(s,t){let r=s.options.slice(),a=s.options.findIndex(u=>u.id===t.id);return a===-1?s:(r.splice(a,1),{...s,options:r})}},X=i.createContext(null);X.displayName="RadioGroupDataContext";function Z(s){let t=i.useContext(X);if(t===null){let r=new Error(`<${s} /> is missing a parent <RadioGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Z),r}return t}let ee=i.createContext(null);ee.displayName="RadioGroupActionsContext";function se(s){let t=i.useContext(ee);if(t===null){let r=new Error(`<${s} /> is missing a parent <RadioGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,se),r}return t}function ze(s,t){return _e(t.type,Ye,s,t)}let Je="div";function Xe(s,t){let r=i.useId(),a=ie(),{id:u=`headlessui-radiogroup-${r}`,value:x,form:v,name:m,onChange:p,by:w,disabled:b=a||!1,defaultValue:l,...y}=s,c=Be(w),[N,f]=i.useReducer(ze,{options:[]}),h=N.options,[$,D]=ce(),[O,E]=de(),_=i.useRef(null),n=z(_,t),d=Re(l),[o,P]=Se(x,p,d),T=i.useMemo(()=>h.find(g=>!g.propsRef.current.disabled),[h]),I=i.useMemo(()=>h.some(g=>c(g.propsRef.current.value,o)),[h,o]),k=L(g=>{var q;if(b||c(g,o))return!1;let M=(q=h.find(Q=>c(Q.propsRef.current.value,g)))==null?void 0:q.propsRef.current;return M!=null&&M.disabled?!1:(P==null||P(g),!0)}),V=L(g=>{let q=_.current;if(!q)return;let M=Me(q),Q=h.filter(R=>R.propsRef.current.disabled===!1).map(R=>R.element.current);switch(g.key){case F.Enter:De(g.currentTarget);break;case F.ArrowLeft:case F.ArrowUp:if(g.preventDefault(),g.stopPropagation(),ae(Q,H.Previous|H.WrapAround)===re.Success){let R=h.find(U=>U.element.current===(M==null?void 0:M.activeElement));R&&k(R.propsRef.current.value)}break;case F.ArrowRight:case F.ArrowDown:if(g.preventDefault(),g.stopPropagation(),ae(Q,H.Next|H.WrapAround)===re.Success){let R=h.find(U=>U.element.current===(M==null?void 0:M.activeElement));R&&k(R.propsRef.current.value)}break;case F.Space:{g.preventDefault(),g.stopPropagation();let R=h.find(U=>U.element.current===(M==null?void 0:M.activeElement));R&&k(R.propsRef.current.value)}break}}),te=L(g=>(f({type:0,...g}),()=>f({type:1,id:g.id}))),be=i.useMemo(()=>({value:o,firstOption:T,containsCheckedOption:I,disabled:b,compare:c,...N}),[o,T,I,b,c,N]),ye=i.useMemo(()=>({registerOption:te,change:k}),[te,k]),je={ref:n,id:u,role:"radiogroup","aria-labelledby":$,"aria-describedby":O,onKeyDown:V},ve=i.useMemo(()=>({value:o}),[o]),Ne=i.useCallback(()=>{if(d!==void 0)return k(d)},[k,d]),we=J();return A.createElement(E,{name:"RadioGroup.Description"},A.createElement(D,{name:"RadioGroup.Label"},A.createElement(ee.Provider,{value:ye},A.createElement(X.Provider,{value:be},m!=null&&A.createElement($e,{disabled:b,data:{[m]:o||"on"},overrides:{type:"radio",checked:o!=null},form:v,onReset:Ne}),we({ourProps:je,theirProps:y,slot:ve,defaultTag:Je,name:"RadioGroup"})))))}let Ze="div";function es(s,t){var r;let a=Z("RadioGroup.Option"),u=se("RadioGroup.Option"),x=i.useId(),{id:v=`headlessui-radiogroup-option-${x}`,value:m,disabled:p=a.disabled||!1,autoFocus:w=!1,...b}=s,l=i.useRef(null),y=z(l,t),[c,N]=ce(),[f,h]=de(),$=oe({value:m,disabled:p});ue(()=>u.registerOption({id:v,element:l,propsRef:$}),[v,u,l,$]);let D=L(k=>{var V;if(he(k.currentTarget))return k.preventDefault();u.change(m)&&((V=l.current)==null||V.focus())}),O=((r=a.firstOption)==null?void 0:r.id)===v,{isFocusVisible:E,focusProps:_}=me({autoFocus:w}),{isHovered:n,hoverProps:d}=pe({isDisabled:p}),o=a.compare(a.value,m),P=xe({ref:y,id:v,role:"radio","aria-checked":o?"true":"false","aria-labelledby":c,"aria-describedby":f,"aria-disabled":p?!0:void 0,tabIndex:p?-1:o||!a.containsCheckedOption&&O?0:-1,onClick:p?void 0:D,autoFocus:w},_,d),T=i.useMemo(()=>({checked:o,disabled:p,active:E,hover:n,focus:E,autofocus:w}),[o,p,n,E,w]),I=J();return A.createElement(h,{name:"RadioGroup.Description"},A.createElement(N,{name:"RadioGroup.Label"},I({ourProps:P,theirProps:b,slot:T,defaultTag:Ze,name:"RadioGroup.Option"})))}let ss="span";function ts(s,t){var r;let a=Z("Radio"),u=se("Radio"),x=i.useId(),v=Pe(),m=ie(),{id:p=v||`headlessui-radio-${x}`,value:w,disabled:b=a.disabled||m||!1,autoFocus:l=!1,...y}=s,c=i.useRef(null),N=z(c,t),f=Oe(),h=Ee(),$=oe({value:w,disabled:b});ue(()=>u.registerOption({id:p,element:c,propsRef:$}),[p,u,c,$]);let D=L(I=>{var k;if(he(I.currentTarget))return I.preventDefault();u.change(w)&&((k=c.current)==null||k.focus())}),{isFocusVisible:O,focusProps:E}=me({autoFocus:l}),{isHovered:_,hoverProps:n}=pe({isDisabled:b}),d=((r=a.firstOption)==null?void 0:r.id)===p,o=a.compare(a.value,w),P=xe({ref:N,id:p,role:"radio","aria-checked":o?"true":"false","aria-labelledby":f,"aria-describedby":h,"aria-disabled":b?!0:void 0,tabIndex:b?-1:o||!a.containsCheckedOption&&d?0:-1,autoFocus:l,onClick:b?void 0:D},E,n),T=i.useMemo(()=>({checked:o,disabled:b,hover:_,focus:O,autofocus:l}),[o,b,_,O,l]);return J()({ourProps:P,theirProps:y,slot:T,defaultTag:ss,name:"Radio"})}let as=Y(Xe),rs=Y(es),ns=Y(ts),ls=ke,is=Ce,W=Object.assign(as,{Option:rs,Radio:ns,Label:ls,Description:is});const j=[];for(let s=0;s<256;++s)j.push((s+256).toString(16).slice(1));function cs(s,t=0){return(j[s[t+0]]+j[s[t+1]]+j[s[t+2]]+j[s[t+3]]+"-"+j[s[t+4]]+j[s[t+5]]+"-"+j[s[t+6]]+j[s[t+7]]+"-"+j[s[t+8]]+j[s[t+9]]+"-"+j[s[t+10]]+j[s[t+11]]+j[s[t+12]]+j[s[t+13]]+j[s[t+14]]+j[s[t+15]]).toLowerCase()}let B;const ds=new Uint8Array(16);function os(){if(!B){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");B=crypto.getRandomValues.bind(crypto)}return B(ds)}const us=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),le={randomUUID:us};function ms(s,t,r){var u;if(le.randomUUID&&!s)return le.randomUUID();s=s||{};const a=s.random??((u=s.rng)==null?void 0:u.call(s))??os();if(a.length<16)throw new Error("Random bytes length must be >= 16");return a[6]=a[6]&15|64,a[8]=a[8]&63|128,cs(a)}function ps({items:s,onUpdateQuantity:t,onRemove:r}){return s.length===0?e.jsx("div",{className:"rounded-lg bg-white p-6 text-center sm:p-8",children:e.jsx("p",{children:"Your cart is empty"})}):e.jsxs("div",{className:"rounded-lg bg-white",children:[e.jsx("div",{className:"divide-y lg:hidden",children:s.map(a=>e.jsx("div",{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"relative h-20 w-20 shrink-0 overflow-hidden rounded-lg bg-gray-100 sm:h-24 sm:w-24",children:e.jsx("img",{src:"http://localhost:4000/"+a.product.images[0].url||"/placeholder.svg",alt:a.product.name,crossOrigin:"anonymous",className:"object-contain w-full h-full"})}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:e.jsx("h3",{className:"font-medium",children:a.product.name})}),e.jsx("p",{className:"text-sm font-medium",children:C(a.product.price*(100-a.product.discount)/100)})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center rounded-lg border",children:[e.jsx("button",{onClick:()=>t(a.cart_item_id,a.quantity-1),className:"px-3 py-1 text-gray-600 hover:text-gray-700",children:"-"}),e.jsx("span",{className:"w-12 text-center text-sm",children:a.quantity}),e.jsx("button",{onClick:()=>t(a.cart_item_id,a.quantity+1),className:"px-3 py-1 text-gray-600 hover:text-gray-700",children:"+"})]}),e.jsx("button",{type:"button",onClick:()=>r(a.cart_item_id),className:"text-sm text-gray-500 hover:text-gray-700",children:"Remove"})]}),e.jsxs("div",{className:"mt-2 flex justify-between border-t pt-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Subtotal"}),e.jsx("span",{className:"text-sm font-medium",children:C(a.product.price*(100-a.product.discount)/100*a.quantity)})]})]})]})},a.product_id))}),e.jsx("div",{className:"hidden lg:block",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-4 pl-8 text-left",children:"Product"}),e.jsx("th",{className:"px-4 py-4 text-center",children:"Quantity"}),e.jsx("th",{className:"px-4 py-4 text-right",children:"Price"}),e.jsx("th",{className:"px-8 py-4 text-right",children:"Subtotal"})]})}),e.jsx("tbody",{className:"divide-y",children:s.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-4 pl-8",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"relative h-20 w-20 shrink-0 overflow-hidden rounded-lg bg-gray-100",children:e.jsx("img",{src:"http://localhost:4000/"+a.product.images[0].url||"/placeholder.svg",alt:a.product.name,crossOrigin:"anonymous",className:"object-contain w-full h-full"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:a.product.name}),e.jsx("button",{onClick:()=>r(a.cart_item_id),className:"mt-1 text-sm text-red-500 hover:text-red-700",children:"Remove"})]})]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"flex items-center rounded-lg border",children:[e.jsx("button",{onClick:()=>t(a.cart_item_id,a.quantity-1),className:"px-3 py-1 text-gray-600 hover:text-gray-700",children:"-"}),e.jsx("span",{className:"w-12 text-center",children:a.quantity}),e.jsx("button",{onClick:()=>t(a.cart_item_id,a.quantity+1),className:"px-3 py-1 text-gray-600 hover:text-gray-700",children:"+"})]})})}),e.jsx("td",{className:"px-4 py-4 text-right",children:C(a.product.price*(100-a.product.discount)/100)}),e.jsx("td",{className:"px-8 py-4 text-right",children:C(a.product.price*(100-a.product.discount)/100*a.quantity)})]},a.product_id))})]})})]})}function xs({currentStep:s,steps:t}){return e.jsxs("div",{className:"relative flex justify-between px-4 sm:px-0",children:[e.jsx("div",{className:"absolute left-0 top-[15px] h-[2px] w-full bg-gray-200",children:e.jsx("div",{className:"h-full bg-black transition-all duration-300",style:{width:`${(s-1)/(t.length-1)*100}%`}})}),e.jsx("div",{className:"relative flex w-full justify-between",children:t.map(r=>e.jsxs("div",{className:`flex flex-col items-center ${r.number<=s?"text-black":"text-gray-400"}`,children:[e.jsx("div",{className:`mb-2 flex h-8 w-8 items-center justify-center rounded-full ${r.number<=s?"bg-black text-white":r.number<s?"bg-green-500 text-white":"bg-gray-200"}`,children:r.number<s?e.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):r.number}),e.jsx("span",{className:"text-center text-xs sm:text-sm",children:r.label})]},r.number))})]})}function hs({subtotal:s,shipping:t,total:r,shippingMethod:a,onShippingChange:u,onClick:x}){const v=[{id:"free",label:"Free shipping",price:0},{id:"express",label:"Express shipping",price:15e3},{id:"pickup",label:"Pick Up",price:21e3}];return e.jsxs("div",{className:"rounded-lg bg-white p-4 sm:p-6",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Cart summary"}),e.jsx("div",{className:"mt-4 space-y-2",children:e.jsxs(W,{value:a,onChange:u,children:[e.jsx(W.Label,{className:"sr-only",children:"Shipping method"}),e.jsx("div",{className:"space-y-2",children:v.map(m=>e.jsx(W.Option,{value:m.id,className:({checked:p})=>`relative flex cursor-pointer rounded-lg border p-3 sm:p-4 focus:outline-none ${p?"border-black":"border-gray-200"} hover:border-black`,children:({checked:p})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"text-sm",children:e.jsx(W.Label,{as:"p",className:`font-medium ${p?"text-black":"text-gray-900"}`,children:m.label})})}),e.jsx("div",{className:"text-sm font-medium",children:C(m.price)})]})})},m.id))})]})}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"flex justify-between text-sm sm:text-base",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{children:C(s)})]}),e.jsxs("div",{className:"flex justify-between text-sm sm:text-base",children:[e.jsx("span",{children:"Shipping"}),e.jsx("span",{children:C(t)})]}),e.jsxs("div",{className:"flex justify-between border-t pt-4 text-base font-semibold sm:text-lg",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:C(r)})]})]}),e.jsx("button",{onClick:x,className:"mt-6 w-full rounded-lg bg-black py-3 text-center text-sm font-semibold text-white hover:bg-gray-900",children:"Checkout"})]})}function fs({onSubmit:s}){const[t,r]=i.useState("credit-card"),{register:a,handleSubmit:u,setValue:x,formState:{errors:v}}=Ae(),m=fe(),{addresses:p}=G(c=>c.address),{cartItems:w}=G(c=>c.cart),b=ge();i.useEffect(()=>{m(Te())},[m]),i.useEffect(()=>{const c=p.find(N=>N.is_default);if(c)for(const[N,f]of Object.entries(c))x(N,f)},[p,x]);const l=p.find(c=>c.is_default),y=c=>{if(!l){S.error("Please add an address to continue");return}const N={address_id:l.address_id,items:w.map(f=>({name:f.product.name,price:f.product.price*(100-f.product.discount)/100,quantity:f.quantity,product_id:f.product.product_id,images:f.product.images})),paymentMethod:t};s(N)};return e.jsxs("form",{onSubmit:u(y),className:"space-y-6",children:[l?e.jsxs("div",{className:"rounded-lg bg-white p-6 border border-gray-200",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Default Address"}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:l.full_name}),e.jsx("p",{className:"text-sm text-gray-500",children:l.phone}),e.jsxs("p",{className:"text-sm text-gray-500",children:[l.address_line1,","," ",l.address_line2&&`${l.address_line2}, `,l.city,", ",l.state,","," ",l.country,", ",l.postal_code]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{type:"button",onClick:()=>b("/account/address",{state:{fromCheckout:!0}}),className:"inline-flex items-center rounded-md bg-black px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-gray-900",children:"Select a Different Address"})})]}):e.jsxs("div",{className:"rounded-lg bg-white p-6 border border-gray-200",children:[e.jsx("h2",{className:"text-lg font-medium",children:"No Address Found"}),e.jsx("div",{className:"mt-4",children:e.jsx(K,{to:"/account/address/add",className:"inline-flex items-center rounded-md bg-black px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-gray-900",children:"Add New Address"})})]}),e.jsxs("div",{className:"rounded-lg bg-white p-6 border border-gray-200",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Payment Method"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"radio",id:"credit-card",name:"paymentMethod",value:"credit-card",checked:t==="credit-card",onChange:c=>r(c.target.value),className:"h-4 w-4 border-gray-300 text-black focus:ring-black"}),e.jsx("label",{htmlFor:"credit-card",className:"text-sm font-medium text-gray-700",children:"Thanh toÃ¡n vá»›i ngÃ¢n hÃ ng"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"radio",id:"momo",name:"paymentMethod",value:"momo",checked:t==="momo",onChange:c=>r(c.target.value),className:"h-4 w-4 border-gray-300 text-black focus:ring-black"}),e.jsx("label",{htmlFor:"momo",className:"text-sm font-medium text-gray-700",children:"MoMo"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"radio",id:"cod",name:"paymentMethod",value:"cod",checked:t==="cod",onChange:c=>r(c.target.value),className:"h-4 w-4 border-gray-300 text-black focus:ring-black"}),e.jsx("label",{htmlFor:"cod",className:"text-sm font-medium text-gray-700",children:"Cash on Delivery"})]}),t==="credit-card"&&e.jsx("div",{className:"mt-4 space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"qrCode",className:"block text-sm font-medium text-gray-700",children:"Scan QR Code"}),e.jsx("img",{src:"/path/to/qr-code.png",alt:"QR Code",className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm"})]})})]})]}),e.jsx("button",{type:"submit",className:"w-full rounded-lg bg-black py-3 text-sm font-semibold text-white transition-colors hover:bg-gray-900",children:"Place Order"})]})}function gs(){const s=t=>{t.preventDefault(),alert("Applying coupon...")};return e.jsxs("div",{className:"rounded-lg bg-white p-4 sm:p-6",children:[e.jsx("h3",{className:"font-medium",children:"Have a coupon?"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Add your code for an instant cart discount"}),e.jsxs("form",{onSubmit:s,className:"mt-4 flex flex-col gap-2 sm:flex-row",children:[e.jsx("input",{type:"text",placeholder:"Coupon Code",className:"flex-1 rounded-lg border px-4 py-2 focus:border-gray-500 focus:outline-none"}),e.jsx("button",{type:"submit",className:"rounded-lg border px-6 py-2 font-medium hover:bg-gray-50",children:"Apply"})]})]})}function bs({items:s,shippingMethod:t,shippingCost:r}){const a=s.reduce((x,v)=>x+v.price*v.quantity,0),u=a+r;return e.jsxs("div",{className:"rounded-lg bg-white p-6",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Order Summary"}),e.jsx("div",{className:"mt-6 divide-y",children:s.map(x=>e.jsxs("div",{className:"flex gap-4 py-4",children:[e.jsx("div",{className:"relative h-20 w-20 shrink-0 overflow-hidden rounded-lg bg-gray-100",children:e.jsx("img",{src:"http://localhost:4000/"+x.product.images[0].url||"/placeholder.svg",crossOrigin:"anonymous",alt:x.name,className:"object-contain w-full h-full"})}),e.jsxs("div",{className:"flex flex-1 flex-col justify-between",children:[e.jsx("div",{children:e.jsx("h3",{className:"font-medium",children:x.product.name})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center rounded-lg border px-2 py-1",children:e.jsxs("span",{className:"text-sm",children:["Qty: ",x.quantity]})}),e.jsx("p",{className:"font-medium",children:C(x.product.price*(100-x.product.discount)/100)})]})]})]},x.cart_item_id))}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{children:C(a)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:["Shipping (",t,")"]}),e.jsx("span",{children:C(r)})]}),e.jsxs("div",{className:"flex justify-between border-t pt-4 text-base font-semibold",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:C(u)})]})]}),e.jsx("div",{className:"mt-6",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Input",className:"flex-1 rounded-lg border px-3 py-2 focus:border-gray-500 focus:outline-none"}),e.jsx("button",{className:"rounded-lg bg-black px-4 py-2 text-sm font-medium text-white hover:bg-gray-900",children:"Apply"})]})})]})}const js=()=>{const s=fe(),t=Fe(),r=ge(),{userInfo:a}=G(n=>n.auth),{cartItems:u,loadingCart:x}=G(n=>n.cart),{loading:v}=G(n=>n.orders);i.useEffect(()=>{a&&s(ne())},[s,a]),i.useEffect(()=>{const n=new URLSearchParams(t.search),d=parseInt(n.get("step"),10);if(![1,2,3].includes(d)){y(1),n.set("step",1),r({search:n.toString()},{replace:!0});return}if(!x){if(d===2||d===3){if(!a){y(1),n.set("step",1),r({search:n.toString()},{replace:!0});return}if(d===2&&u.length===0){S.error("Your cart is empty"),y(1),n.set("step",1),r({search:n.toString()},{replace:!0});return}}y(d)}},[u.length,x,t.search,r,a]);const[m,p]=i.useState("free"),[w,b]=i.useState("cod"),[l,y]=i.useState(1),c=async(n,d)=>{var o;try{await s(Ge({id:n,quantity:d})).unwrap(),await s(ne()).unwrap(),S.success("Quantity updated")}catch(P){if(((o=P.response)==null?void 0:o.status)===401){S.error("Please login to update quantity");return}S.error(P.message||"Error updating quantity")}},N=async n=>{try{await s(Ve(n)).unwrap(),S.success("Item removed from cart")}catch(d){S.error(d.message||"Error removing item")}},f=i.useMemo(()=>u.reduce((n,d)=>n+d.price*d.quantity,0),[u]),h=i.useMemo(()=>({free:0,express:15e3,pickup:21e3}),[]),$=i.useMemo(()=>f+h[m],[f,m,h]),D=async n=>{try{let d={};s(Qe({...n,shipping:h[m]})).then(async o=>{if(console.log(o),d=o.payload.data,b(n.paymentMethod),n.paymentMethod==="cod"&&(S.success("Order submitted successfully"),y(3)),n.paymentMethod==="credit-card"&&(S.success("Redirecting to payment gateway"),setTimeout(()=>{y(3)},3e3)),n.paymentMethod==="momo"){const P=await He.post("/orders/payment-with-momo",{total:Number($)+Number(h[m]),orderId:d.order_id});window.location.href=P.data,y(3),setTimeout(()=>{y(3)},3e3)}}).catch(o=>{console.log(o),S.error(o.message||"Error submitting order")})}catch(d){S.error(d.message||"Error submitting order")}},O=n=>{if(n===2&&(!a||u.length===0)){S.error("Please login and ensure your cart is not empty to proceed.");return}y(n);const d=new URLSearchParams(t.search);d.set("step",n),r({search:d.toString()})},E=()=>{l>1&&O(l-1)},_=[{number:1,label:"Shopping cart"},{number:2,label:"Checkout details"},{number:3,label:"Order complete"}];return e.jsxs("div",{className:"min-h-screen bg-gray-50 px-4 py-8 sm:px-6 lg:px-8",children:[v&&e.jsx(qe,{}),e.jsxs("div",{className:"mx-auto max-w-7xl",children:[e.jsx("h1",{className:"mb-6 text-center text-2xl font-bold sm:mb-8 sm:text-3xl",children:"Cart"}),e.jsx(xs,{currentStep:l,steps:_}),l===1&&e.jsxs("div",{className:"mt-6 space-y-6 sm:mt-8 lg:grid lg:grid-cols-12 lg:gap-8 lg:space-y-0",children:[e.jsxs("div",{className:"lg:col-span-8",children:[e.jsx(ps,{items:u,onUpdateQuantity:c,onRemove:N}),e.jsx("div",{className:"mt-6",children:e.jsx(gs,{})})]}),e.jsx("div",{className:"lg:col-span-4",children:e.jsx(hs,{subtotal:f,shipping:h[m],total:$,shippingMethod:m,onShippingChange:p,onClick:()=>O(2)})})]}),l===2&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-6 space-y-6 sm:mt-8 lg:grid lg:grid-cols-12 lg:gap-8 lg:space-y-0",children:[e.jsx("div",{className:"lg:col-span-7",children:e.jsx(fs,{onSubmit:D})}),e.jsx("div",{className:"lg:col-span-5",children:e.jsx(bs,{items:u,shippingMethod:m,shippingCost:h[m]})})]}),e.jsx("button",{onClick:E,className:"mt-4 rounded-lg bg-gray-200 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-300",children:"Back"})]}),l===3&&e.jsx("div",{className:"mt-8 flex justify-center",children:e.jsxs("div",{className:"w-full max-w-2xl rounded-lg bg-white p-6 text-center shadow-sm sm:p-8",children:[e.jsx("h2",{className:"mb-6 text-xl font-medium sm:text-2xl",children:"Thank you! ðŸŽ‰"}),e.jsx("p",{className:"mb-8 text-lg text-gray-600",children:"Your order has been received"}),e.jsxs("div",{className:"mx-auto mb-8 max-w-sm space-y-3 text-sm sm:text-base",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 text-start",children:"Order code:"}),e.jsx("span",{className:"font-medium text-end",children:ms()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Date:"}),e.jsx("span",{className:"font-medium",children:Ue(Date.now())})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total:"}),e.jsx("span",{className:"font-medium",children:C($)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Payment method:"}),e.jsx("span",{className:"font-medium",children:w.toUpperCase()})]})]}),e.jsxs("div",{className:"space-y-4 sm:space-x-4 sm:space-y-0",children:[e.jsx("button",{className:" py-1.5 px-3 bg-slate-400 text-white font-semibold rounded-2xl shadow-lg hover:from-purple-500 hover:to-blue-500 transition-all duration-300 transform hover:scale-105 active:scale-95",children:e.jsx(K,{to:"/account/orders",children:"Purchase history"})}),e.jsx(Le,{className:"inline-flex items-center gap-2 rounded-2xl bg-gray-700 py-1.5 px-3 text-sm/6 font-semibold text-white shadow-inner shadow-white/10 focus:outline-none data-[hover]:bg-gray-600 data-[open]:bg-gray-700 data-[focus]:outline-1 data-[focus]:outline-white",children:e.jsx(K,{to:"/shop",children:"Continue Shopping"})})]})]})})]})]})};export{js as default};
